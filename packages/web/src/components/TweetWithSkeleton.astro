---
import { Tweet } from '@astro-community/astro-embed-twitter';

interface Props {
  id: string;
  theme?: 'light' | 'dark';
}

const { id, theme = 'dark' } = Astro.props;
---

<div class="tweet-embed w-full max-w-[400px] min-h-[500px] lg:min-h-[700px]">
  <div class="tweet-skeleton w-full h-full min-h-[600px] lg:min-h-[700px] rounded-xl border border-border/50 bg-card/50 p-4 animate-pulse flex flex-col">
    <div class="flex items-center gap-3 mb-3">
      <div class="w-10 h-10 rounded-full bg-muted/50"></div>
      <div class="flex flex-col gap-1.5">
        <div class="w-24 h-4 rounded bg-muted/50"></div>
        <div class="w-16 h-3 rounded bg-muted/50"></div>
      </div>
    </div>
    <div class="flex flex-col gap-2 mb-3">
      <div class="w-full h-4 rounded bg-muted/50"></div>
      <div class="w-3/4 h-4 rounded bg-muted/50"></div>
    </div>
    <div class="w-full flex-1 rounded-lg bg-muted/50 mb-3"></div>
    <div class="w-32 h-3 rounded bg-muted/50"></div>
  </div>
  <div class="tweet-content">
    <Tweet theme={theme} id={id} />
  </div>
</div>

<style is:global>
  /* Hide static blockquote immediately to prevent flash */
  .tweet-content .twitter-tweet:not(.twitter-tweet-rendered) {
    display: none !important;
  }
</style>

<style>
  .tweet-embed iframe,
  .tweet-embed .twitter-tweet {
    max-width: 400px !important;
  }
  /* Hide skeleton when tweet loads */
  .tweet-embed:has(iframe) .tweet-skeleton,
  .tweet-embed:has(.twitter-tweet-rendered) .tweet-skeleton {
    display: none;
  }
  /* Hide static blockquote when JS is enabled (skeleton shows instead) */
  .tweet-embed .twitter-tweet:not(.twitter-tweet-rendered) {
    display: none;
  }
  /* Show static blockquote only for no-JS users */
  @media (scripting: none) {
    .tweet-embed .tweet-skeleton {
      display: none;
    }
    .tweet-embed .twitter-tweet {
      display: block !important;
    }
  }
</style>
