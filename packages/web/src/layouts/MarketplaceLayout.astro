---
import { ClientRouter } from 'astro:transitions'
import Analytics from '@vercel/analytics/astro';
import "../styles/global.css";
import { GithubIcon } from "../components/ui/github";
import { DiscordIcon } from "../components/ui/discord";

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
  keywords?: string;
  canonicalUrl?: string;
}

const {
  title= 'Claude Plugins & Agent Skills - Community Registry with CLI',
  description = 'Install Claude Code plugins and Agent Skills for Claude, Cursor, Codex, OpenCode, Amp Code, VS Code, Goose, and Letta. Simple CLI tool that handles setup automatically. Browse and install from indexed public plugins and skills.',
  ogImage = '/og-image.png',
  keywords = 'Agent Skills, agentskills.io, Claude Code plugins, Claude Code CLI, plugin manager, AI development tools, Claude AI plugins, Cursor agent skills, VS Code AI skills, OpenCode skills, Amp Code skills, Codex skills, Letta skills, Goose skills, developer tools, npm packages, plugin marketplace, skills registry',
  canonicalUrl = Astro.url.href
} = Astro.props;

const siteUrl = 'https://claude-plugins.dev';
const fullOgImage = ogImage.startsWith('http') ? ogImage : `${siteUrl}${ogImage}`;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="author" content="Claude Plugins Community" />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalUrl} />

    <!-- Theme Color -->
    <meta name="theme-color" content="#000000" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={fullOgImage} />
    <meta property="og:site_name" content="Claude Code Plugins" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalUrl} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={fullOgImage} />

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English" />

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "name": "Claude Code Plugins",
          "alternateName": "Agent Skills Directory",
          "url": "https://claude-plugins.dev",
          "description": "Community registry for Claude plugins and Agent Skills compatible with Claude, Cursor, VS Code, OpenCode, Codex, Amp Code, Letta, and Goose",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://claude-plugins.dev/?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        },
        {
          "@type": "Organization",
          "name": "Claude Code Plugins",
          "alternateName": "Agent Skills Directory",
          "url": "https://claude-plugins.dev",
          "description": "Community registry for Claude plugins and Agent Skills compatible with Claude, Cursor, VS Code, OpenCode, Codex, Amp Code, Letta, and Goose",
          "sameAs": [
            "https://github.com/Kamalnrf/claude-plugins",
            "https://discord.gg/Pt9uN4FXR4"
          ]
        }
      ]
    }
    </script>
    
    <!-- Custom head slot for additional meta tags -->
    <slot name="head" />
    
    <ClientRouter />
  </head>
  <body class="max-w-4xl mx-auto overflow-x-hidden">
    <header transition:persist class="flex items-start md:items-center justify-between px-4 md:px-6 pt-10 pb-4 border-b border-border/50">
      <div>
        <a
          href="/"
          class="text-2xl md:text-3xl font-serif font-bold tracking-tight bg-gradient-to-r from-primary via-primary to-orange-400 bg-clip-text text-transparent hover:opacity-80 transition-opacity"
        >
          Claude Code Plugins
        </a>
        <p class="text-muted-foreground/80 text-sm mt-1.5 tracking-wide">
          Community-maintained marketplace
        </p>
      </div>
      <div class="flex items-center gap-4">
        <a
          href="https://discord.gg/K4TbR3d7"
          target="_blank"
          rel="noopener noreferrer"
          class="text-sm text-muted-foreground hover:text-primary transition-colors font-medium"
        >
          Feedback
        </a>
        <a
          href="https://discord.gg/Pt9uN4FXR4"
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-primary transition-all hover:scale-110"
        >
          <DiscordIcon size={24} client:load />
        </a>
        <a
          href="https://github.com/Kamalnrf/claude-plugins"
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-primary transition-all hover:scale-110"
        >
          <GithubIcon size={24} client:load />
        </a>
      </div>
    </header>

    <main class="min-h-screen">
      <slot />
    </main>
    <Analytics />
  </body>
</html>
